-- Problem Statement 5: 
-- Calculate Revenue by Category
-- Design a stored procedure that calculates the total revenue generated by each film category.
-- The procedure should output a report showing the revenue for each category and the percentage
-- of total revenue it represents.


DELIMITER //
CREATE PROCEDURE total_revenue()
BEGIN
    select name,sum(amount) as Revenue, (sum(amount)*100)/ (select sum(amount) from payment) as  Percentage from
    category join film_category 
    on category.category_id=film_category.category_id
    join film on 
    film_category.film_id=film.film_id 
    join inventory on
    film.film_id=inventory.film_id
    join rental on
    inventory.inventory_id=rental.inventory_id
    join payment on 
    rental.rental_id=payment.rental_id
    group by name;
END
//
DELIMITER ;


call total_revenue();
drop procedure total_revenue;